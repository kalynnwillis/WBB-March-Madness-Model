---
title: "Women's Basketball March Madness: Bradley-Terry Model Analysis"
subtitle: "Analyzing 8-12 Seed Advancement Probabilities"
author: "Your Names Here"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    theme: flatly
    code_folding: hide
    fig_width: 10
    fig_height: 6
  pdf_document:
    toc: true
    toc_depth: 3
    fig_width: 10
    fig_height: 6
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    message = FALSE,
    warning = FALSE,
    fig.align = "center"
)

library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
```

# Executive Summary

This report presents a comprehensive analysis of Women's NCAA Basketball March Madness tournament outcomes using Bradley-Terry models. We focus specifically on mid-tier seeds (8-12) to answer two key questions:

1. **How many 8-12 seeds should we expect to advance past the second round?**
2. **Given that an 8-12 seed advances past the second round, what is the probability they reach the finals or win the championship?**

Additionally, we extend our analysis to calculate **individual team probabilities** for each specific 8-12 seed team, allowing us to identify which teams are most likely to make deep tournament runs and to contextualize the 2023-2024 historical result where zero 8-12 seeds reached the Sweet 16.

## Key Findings

```{r load-results, echo=FALSE}
# Load key results
key_results <- readRDS(here("results", "tables", "key_results.rds"))
sweet16_probs <- read_csv(
    here("results", "tables", "sweet16_mid_tier_probabilities.csv"),
    show_col_types = FALSE
)
```

**Aggregate Analysis (all 8-12 seeds):**

- **Expected 8-12 seeds in Sweet 16:** `r sprintf("%.2f", key_results$expected_in_sweet16)` teams
- **Conditional probability of reaching Finals (given Sweet 16):** `r sprintf("%.1f%%", key_results$overall_conditional$prob_finals_given_s16 * 100)`
- **Conditional probability of winning championship (given Sweet 16):** `r sprintf("%.1f%%", key_results$overall_conditional$prob_champion_given_s16 * 100)`

**Individual Team Analysis:**

- **Highest Sweet 16 probability:** `r sweet16_probs$winner_name[1]` (`r sweet16_probs$seed[1]`-seed) at `r sprintf("%.1f%%", sweet16_probs$percentage[1])`
- **2023-2024 Context:** Zero 8-12 seeds reached Sweet 16 (17.9% probability - unusual but not impossible)

---

# 1. Introduction

## 1.1 Background

The NCAA Women's Basketball Tournament, commonly known as March Madness, is a single-elimination tournament featuring 64 teams seeded 1-16 across four regions. Understanding the probability of upsets and the advancement potential of mid-tier seeds is valuable for:

- Bracket predictions
- Understanding competitive balance
- Identifying over/under-seeded teams

## 1.2 Research Questions

**Research Question 1:** How many of the 8-12 seeds should we expect to advance past the second round (to the Sweet 16)?

**Research Question 2:** Given that a team ranked 8-12 advanced past the second round, what is the chance they make it all the way to the finals or win the championship?

## 1.3 Why Focus on 8-12 Seeds?

We focus on 8-12 seeds because they represent an interesting competitive sweet spot:

- **Not automatic first-round exits** (unlike 13-16 seeds)
- **Not overwhelming favorites** (unlike 1-4 seeds)
- **Competitive upset potential** - capable of deep runs but face significant challenges
- **Strategic interest** - key for bracket predictions

---

# 2. Methodology

## 2.1 Bradley-Terry Model

The Bradley-Terry model estimates latent team strengths from pairwise comparisons (game results). For each team $i$, the model assigns a strength parameter $\lambda_i$ such that:

$$P(\text{team } i \text{ beats team } j) = \frac{1}{1 + e^{-(\lambda_i - \lambda_j)}}$$

### Key Properties:

- Higher $\lambda$ indicates stronger team
- Log-odds of winning = difference in strengths
- Identifiable only up to additive constant (we fix one team's $\lambda = 0$)

## 2.2 Data

```{r data-summary, echo=FALSE}
# Load data info
team_abilities <- readRDS(here("data", "processed", "team_abilities_with_seeds.rds"))
games_cleaned <- readRDS(here("data", "processed", "games_cleaned.rds"))

n_teams <- nrow(team_abilities)
n_games <- nrow(games_cleaned)
n_tournament_teams <- sum(!is.na(team_abilities$seed))
n_mid_tier <- sum(team_abilities$seed >= 8 & team_abilities$seed <= 12, na.rm = TRUE)
```

**Data Source:** Women's NCAA Basketball data via `wncaahoopR` package

**Dataset Statistics:**

- Total teams analyzed: `r n_teams`
- Total games: `r n_games`
- Tournament teams: `r n_tournament_teams`
- Teams with 8-12 seeds: `r n_mid_tier`

## 2.3 Analysis Approach

Our analysis consists of three components:

1. **Bradley-Terry Model Fitting** - Estimate team strengths from regular season games
2. **Analytical Probability Calculations** - Calculate exact probabilities for specific matchups
3. **Monte Carlo Simulation** - Simulate 5,000 complete tournaments to estimate complex probabilities

---

# 3. Results

## 3.1 Team Strength Estimates

```{r team-strength-plot, echo=FALSE, fig.cap="Team strength distribution by seed category"}
knitr::include_graphics(here("results", "figures", "01_team_strength_by_seed.png"))
```

The Bradley-Terry model successfully distinguishes between seed categories, with higher seeds showing systematically higher estimated strengths.

### Top 10 Strongest Teams

```{r top-teams, echo=FALSE}
top_teams <- team_abilities %>%
    filter(!is.na(seed)) %>%
    arrange(desc(lambda)) %>%
    head(10) %>%
    select(
        Team = team, Seed = seed, Region = region,
        Lambda = lambda, `Std. Error` = se
    ) %>%
    mutate(
        Lambda = sprintf("%.3f", Lambda),
        `Std. Error` = sprintf("%.3f", `Std. Error`)
    )

kable(top_teams, caption = "Top 10 Strongest Teams by Bradley-Terry Model") %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
```

## 3.2 First Round Performance (8-12 Seeds)

```{r first-round-plot, echo=FALSE, fig.cap="First round win probabilities for 8-12 seeds"}
knitr::include_graphics(here("results", "figures", "03_first_round_probabilities.png"))
```

```{r first-round-table, echo=FALSE}
first_round_summary <- key_results$first_round_summary %>%
    select(
        Seed = seed, `N Teams` = n_teams,
        `Avg Win Prob` = avg_prob_win, `Expected Wins` = expected_wins
    ) %>%
    mutate(
        `Avg Win Prob` = sprintf("%.1f%%", `Avg Win Prob` * 100),
        `Expected Wins` = sprintf("%.2f", `Expected Wins`)
    )

kable(first_round_summary,
    caption = "First Round Win Probabilities by Seed"
) %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
```

## 3.3 Research Question 1: Expected Advancement

```{r advancement-plot, echo=FALSE, fig.cap="Expected number of 8-12 seeds advancing by round"}
knitr::include_graphics(here("results", "figures", "06_analytical_vs_simulation.png"))
```

### Answer to Research Question 1

**We expect approximately `r sprintf("%.1f", key_results$expected_in_sweet16)` of the 8-12 seeds to advance past the second round (to the Sweet 16).**

```{r advancement-table, echo=FALSE}
advancement <- key_results$second_round_summary %>%
    select(
        Seed = seed, `N Teams` = n_teams,
        `P(Round 2 Win | Round 1 Win)` = avg_prob_win_r2_conditional,
        `P(Sweet 16)` = avg_prob_reach_sweet16,
        `Expected in Sweet 16` = expected_in_sweet16
    ) %>%
    mutate(
        `P(Round 2 Win | Round 1 Win)` = sprintf(
            "%.1f%%",
            `P(Round 2 Win | Round 1 Win)` * 100
        ),
        `P(Sweet 16)` = sprintf("%.1f%%", `P(Sweet 16)` * 100),
        `Expected in Sweet 16` = sprintf("%.2f", `Expected in Sweet 16`)
    )

kable(advancement,
    caption = "Second Round Performance and Sweet 16 Expectations"
) %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
```

### Breakdown by Seed

- **8 seeds:** Most likely to advance (face 9 seeds in Round 1, 1 seeds in Round 2)
- **9 seeds:** Similar probability to 8 seeds
- **10-12 seeds:** Lower but non-negligible probability of Sweet 16

## 3.4 Research Question 2: Conditional Probabilities

```{r conditional-plot, echo=FALSE, fig.cap="Conditional probabilities given Sweet 16 appearance"}
knitr::include_graphics(here("results", "figures", "07_conditional_probabilities.png"))
```

### Answer to Research Question 2

**Given that an 8-12 seed reaches the Sweet 16:**

- Probability of reaching **Elite 8**: `r sprintf("%.1f%%", key_results$overall_conditional$prob_elite8_given_s16 * 100)`
- Probability of reaching **Final Four**: `r sprintf("%.1f%%", key_results$overall_conditional$prob_final4_given_s16 * 100)`
- Probability of reaching **Finals**: `r sprintf("%.1f%%", key_results$overall_conditional$prob_finals_given_s16 * 100)`
- Probability of **winning championship**: `r sprintf("%.1f%%", key_results$overall_conditional$prob_champion_given_s16 * 100)`

```{r conditional-table, echo=FALSE}
conditional <- key_results$conditional_summary %>%
    select(
        Seed = seed,
        `P(Elite 8 | Sweet 16)` = avg_prob_elite8_given_s16,
        `P(Final Four | Sweet 16)` = avg_prob_final4_given_s16,
        `P(Finals | Sweet 16)` = avg_prob_finals_given_s16,
        `P(Champion | Sweet 16)` = avg_prob_champion_given_s16
    ) %>%
    mutate(across(where(is.numeric), ~ sprintf("%.1f%%", . * 100)))

kable(conditional,
    caption = "Conditional Advancement Probabilities by Seed"
) %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
```

## 3.5 Monte Carlo Simulation Results

```{r simulation-plot, echo=FALSE, fig.cap="Distribution of 8-12 seeds by round (5000 simulations)"}
knitr::include_graphics(here("results", "figures", "05_simulation_distributions.png"))
```

### Simulation Validation

The Monte Carlo simulations (5,000 tournament replications) closely match our analytical predictions, providing confidence in our results.

```{r heatmap, echo=FALSE, fig.cap="Seed performance heatmap from simulations"}
knitr::include_graphics(here("results", "figures", "08_seed_performance_heatmap.png"))
```

## 3.6 Individual Team Probabilities

```{r load-individual-results, echo=FALSE}
# Load individual team probability results
team_probs <- readRDS(here("results", "tables", "individual_team_probabilities.rds"))
mid_tier_advancement <- read_csv(
    here("results", "tables", "mid_tier_team_advancement.csv"),
    show_col_types = FALSE
)
```

While the previous sections analyzed 8-12 seeds as a group, we can also calculate the probability that **specific teams** make it to each round. This is particularly relevant given that in 2023 and 2024, **no 8-12 seeds made it to the Sweet 16**.

### Sweet 16 Probabilities by Team

```{r sweet16-individual-plot, echo=FALSE, fig.cap="Individual team probabilities of reaching Sweet 16"}
knitr::include_graphics(here("results", "figures", "09_sweet16_mid_tier_probabilities.png"))
```

```{r sweet16-team-table, echo=FALSE}
sweet16_teams <- mid_tier_advancement %>%
    arrange(desc(`Sweet 16`)) %>%
    select(
        Team = winner_name,
        Seed = seed,
        Region = region,
        `P(Sweet 16)` = `Sweet 16`,
        `P(Elite 8)` = `Elite 8`,
        `P(Final Four)` = `Final Four`
    ) %>%
    mutate(across(where(is.numeric), ~ sprintf("%.1f%%", . * 100)))

kable(sweet16_teams,
    caption = "Individual 8-12 Seed Team Probabilities"
) %>%
    kable_styling(bootstrap_options = c("striped", "hover"))
```

### Key Findings

- **Stanford Cardinal (11-seed)** has the highest Sweet 16 probability among 8-12 seeds at **62.5%**
- **Indiana Hoosiers (8-seed)** follows with **48.5%** probability
- There is substantial variation within the 8-12 seed range based on team strength and bracket positioning

### Historical Context: 2023-2024 Results

```{r historical-context-plot, echo=FALSE, fig.cap="Model predictions vs. observed 2023-2024 results"}
knitr::include_graphics(here("results", "figures", "12_expected_vs_observed.png"))
```

Our model predicts approximately **1.7 8-12 seeds** should reach the Sweet 16 on average. However, in both 2023 and 2024, **zero 8-12 seeds** reached the Sweet 16.

**Statistical Context:**

- Expected number of 8-12 seeds in Sweet 16: **1.72**
- Probability of zero 8-12 seeds reaching Sweet 16: **17.9%**

This suggests the 2023-2024 results were somewhat unusual but **not impossible** - roughly a 1-in-6 chance. Such outcomes can occur due to:

- Random variation (bracket "busts")
- Particularly strong performances by top seeds
- Injuries or other factors not captured in regular season data

### Individual Team Deep Runs

```{r round-progression-plot, echo=FALSE, fig.cap="Round-by-round progression for top 8-12 seeds"}
knitr::include_graphics(here("results", "figures", "10_round_by_round_progression.png"))
```

The chart above shows how the top five 8-12 seeds by Sweet 16 probability progress through each tournament round. Note the steep decline after the Sweet 16, as these teams face increasingly difficult opponents.

### Spotlight: Stanford Cardinal

```{r stanford-spotlight, echo=FALSE, fig.cap="Stanford Cardinal tournament probabilities"}
knitr::include_graphics(here("results", "figures", "13_stanford_spotlight.png"))
```

As an example of individual team analysis, Stanford Cardinal (11-seed, Spokane Region) shows:

- **81.0%** chance of winning Round of 64
- **70.8%** chance of reaching Round of 32
- **62.5%** chance of reaching Sweet 16
- **15.2%** chance of reaching Elite 8
- **4.6%** chance of reaching Final Four

Despite being an 11-seed, Stanford's strong regular season performance (λ = 5.37) gives them elite-8-seed-level probabilities in the early rounds.

### Comprehensive Probability Heatmap

```{r probability-heatmap, echo=FALSE, fig.cap="Heatmap of all 8-12 seed probabilities by round"}
knitr::include_graphics(here("results", "figures", "11_probability_heatmap.png"))
```

This heatmap visualizes all 8-12 seed teams' probabilities across tournament rounds, showing both seed-level patterns and individual team variation.

---

# 4. Discussion

## 4.1 Key Insights

1. **Mid-tier seeds have realistic but challenging paths:** While 8-12 seeds can make deep runs, the probabilities decrease rapidly after the Sweet 16.

2. **Seed matters even within 8-12 range:** 8 and 9 seeds have noticeably better chances than 11 and 12 seeds.

3. **Individual team variation is substantial:** Even within the same seed number, team strength (λ) creates significant differences in advancement probability. Stanford (11-seed) has a 62.5% Sweet 16 probability, much higher than typical 11-seeds.

4. **Historical context matters:** The 2023-2024 result of zero 8-12 seeds in the Sweet 16 has only a 17.9% probability under our model - unusual but not unprecedented.

5. **Model validation:** Strong agreement between analytical predictions and Monte Carlo simulations suggests robust model estimates.

## 4.2 Limitations

- **Constant team strength assumption:** Model doesn't account for injuries, momentum, or hot/cold streaks
- **No home court advantage:** Tournament games at neutral sites, but some teams may have geographic advantages
- **Historical data:** Team compositions change year to year
- **Simplified bracket structure:** Actual tournament has specific regional placements

## 4.3 Practical Applications

- **Bracket Strategy:** Understanding base rates helps avoid over/under-predicting upsets. Individual team probabilities can identify specific "Cinderella" candidates like Stanford.
- **Team Evaluation:** Teams significantly outperforming their seed expectations may be under-seeded. Stanford's 62.5% Sweet 16 probability despite being an 11-seed suggests they may be stronger than their seeding indicates.
- **Tournament Format Analysis:** Quantifies competitive balance in the tournament structure
- **What-if Analysis:** Can model "what if a specific 8-12 seed had made the Sweet 16" scenarios to understand how unusual the 2023-2024 outcomes were

---

# 5. Conclusion

Using Bradley-Terry models combined with Monte Carlo simulation, we provide rigorous answers to our research questions:

1. **Approximately 1.7 of the 8-12 seeds should advance to the Sweet 16** in a typical tournament (range: 0-4)
2. **An 8-12 seed that reaches the Sweet 16 has roughly a 10-20% chance of reaching the Final Four**, but less than 5% chance of winning the championship

Beyond these aggregate findings, our **individual team probability analysis** reveals:

- Substantial variation exists within seed categories based on regular season performance
- Specific teams like **Stanford Cardinal (11-seed, 62.5% Sweet 16 probability)** and **Indiana Hoosiers (8-seed, 48.5%)** are strong candidates for deep runs
- The 2023-2024 observation of zero 8-12 seeds in the Sweet 16, while unusual, occurs naturally about **1 in 6 tournaments** under our model

These findings provide a quantitative framework for understanding mid-tier seed performance in Women's March Madness. The methodology allows analysis at both the **aggregate level** (how many 8-12 seeds overall) and **individual team level** (which specific teams are most likely), making it valuable for bracket predictions, team evaluation, and understanding tournament dynamics.

---

# 6. References

- Bradley, R.A. and Terry, M.E. (1952). "Rank analysis of incomplete block designs." *Biometrika*, 39, 324-345.
- Turner, H. & Firth, D. (2020). *BradleyTerry2: Bradley-Terry Models in R*. R package.
- Nesbitt, S. (2024). *wncaahoopR: Women's NCAA Basketball Data Package*. https://github.com/snestler/wncaahoopR

---

# Appendix: Technical Details

## Model Specification

The Bradley-Terry model was fit using maximum likelihood estimation via the `BradleyTerry2` R package. Regular season games only were included, with exhibition games and NCAA tournament games excluded.

## Computational Details

- **Software:** R 4.x.x
- **Key Packages:** `tidyverse`, `BradleyTerry2`, `wncaahoopR`
- **Simulation:** 5,000 Monte Carlo replications
- **Random Seed:** Set for reproducibility (seed = 479 + iteration)

## Code Availability

All analysis code is available in the project repository:

- `/scripts/01_data_collection_UPDATED.R` - Data collection and cleaning
- `/scripts/02_bradley_terry_model.R` - Model fitting and team strength estimation
- `/scripts/03_seed_analysis.R` - Aggregate seed-level analysis
- `/scripts/04_tournament_simulation.R` - Monte Carlo tournament simulations (5,000 replications)
- `/scripts/05_visualization.R` - Aggregate visualizations
- `/scripts/06_individual_team_probabilities.R` - Individual team probability calculations
- `/scripts/07_individual_team_viz.R` - Individual team visualizations

---

*Report generated on `r Sys.Date()`*

